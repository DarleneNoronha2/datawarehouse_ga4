-- inserts_data


config { type: "operations",
hasOutput: true
}

INSERT INTO dataset.${dataform.projectConfig.vars.DATASET_NAME}.dimension_exc(
  id_extras_consumption,
  user_id_new,
  video_name,
  program_name,
  user_type,
  streaming_type,
  date
)
SELECT
  id_extras_consumption,
  user_id_new,
  video_name,
  program_name,
  user_type,
  streaming_type,
  date,
FROM
    ${ref("manipulate_dimension_exc")};


INSERT INTO  dataset.${dataform.projectConfig.vars.DATASET_NAME}.dimension_md(
  id_movie_details,
  video_id,
  original_headline,
  movie_catalog_id,
  cover_landscape,
  cover_landscape_minified,
  video_description,
  self_rated_content,
  origin_program_id,
  video_encrypted,
  url,
  video_url,
  countries,
  video_archived,
  video_format,
  logo,
  white_logo,
  poster,
  tv_os_poster4k,
  tv_os_poster_hd,
  cover_portrait,
  cover_wide,
  cover_card,
  cover_poster,
  cover,
  epg_active,
  genre_id,
  genre_slug,
  directors_id,
  cast_names,
  cast_id,
  screenwriters_names,
  original_content,
  video_availability_rules,
  service_id,
  channel_id,
  channel_slug,
  subset_headline,
  subset_slug,
  subset_cover,
  structure_origin_program_id,
  structure_title_id,
  structure_type,
  apple_assets_apple_cover_art,
  apple_assets_apple_backdrop_wide,
  apple_assets_apple_backdrop_tall,
  apple_assets_apple_full_color_content_logo,
  apple_assets_apple_single_color_content_logo,
  apple_assets_poster_app,
  technical_specs_audio_layouts,
  content_brand_id,
  content_brand_name,
  content_brand_logo,
  content_brand_trimmed_logo,
  origin_video_id,
  video_kind,
  regions_allowed,
  index_level,
  video_title_origin_program_id,
  video_title_encrypted,
  video_title_epg_active,
  video_accessible_offline,
  video_exhibited_at,
  video_scheduled_unpublication_date,
  video_thumbnails_x90,
  video_thumbnails_x216,
  video_thumbnails_x360,
  video_thumbnails_x720,
  video_thumbnails_x1080,
  video_published,
  video_external_reference_tms_id,
  video_external_reference_tms_root_id,
  video_genre_ids,
  video_genres_slug,
  video_enable_pause_ads,
  video_ad_unit,
  video_ad_custom_data,
  video_subscription_service_id,
  video_subscription_service_name,
  video_subscription_default_service_id,
  dt_partition
)
SELECT
  id_movie_details,
  video_id,
  original_headline,
  movie_catalog_id,
  cover_landscape,
  cover_landscape_minified,
  video_description,
  self_rated_content,
  origin_program_id,
  video_encrypted,
  url,
  video_url,
  countries,
  video_archived,
  video_format,
  logo,
  white_logo,
  poster,
  tv_os_poster4k,
  tv_os_poster_hd,
  cover_portrait,
  cover_wide,
  cover_card,
  cover_poster,
  cover,
  epg_active,
  genre_id,
  genre_slug,
  directors_id,
  cast_names,
 cast_id,
  screenwriters_names,
  original_content,
  video_availability_rules,
  service_id,
  channel_id,
  channel_slug,
  subset_headline,
  subset_slug,
  subset_cover,
  structure_origin_program_id,
  structure_title_id,
  structure_type,
  apple_assets_apple_cover_art,
  apple_assets_apple_backdrop_wide,
  apple_assets_apple_backdrop_tall,
  apple_assets_apple_full_color_content_logo,
  apple_assets_apple_single_color_content_logo,
  apple_assets_poster_app,
  technical_specs_audio_layouts,
  content_brand_id,
  content_brand_name,
  content_brand_logo,
  content_brand_trimmed_logo,
  origin_video_id,
  video_kind,
  regions_allowed,
  index_level,
  video_title_origin_program_id,
  video_title_encrypted,
  video_title_epg_active,
  video_accessible_offline,
  video_exhibited_at,
  video_scheduled_unpublication_date,
  video_thumbnails_x90,
  video_thumbnails_x216,
  video_thumbnails_x360,
  video_thumbnails_x720,
  video_thumbnails_x1080,
  video_published,
  video_external_reference_tms_id,
  video_external_reference_tms_root_id,
  video_genre_ids,
  video_genres_slug,
  video_enable_pause_ads,
  video_ad_unit,
  video_ad_custom_data,
  video_subscription_service_id,
  video_subscription_service_name,
  video_subscription_default_service_id,
  dt_partition
FROM
 ${ref("manipulate_data_dimension_md")} ;
 


INSERT INTO dataset.${dataform.projectConfig.vars.DATASET_NAME}.dimension_tc(
id_consumption,				
user_id_new,
video_id,				
session_id,				
date,				
hour,				
minute,				
user_age,				
user_gender,				
session_name,				
program_name,				
program_details,				
video_name,				
video_name_slug,				
episode_name,			
operacional_system,				
consumption_country,				
consumption_region,				
registration_region,				
consumption_city,				
service_id,				
streaming_type,				
video_type,				
program_id,			
open_video,				
consumption_environment,				
tv_manufacturer,			
tv_model,			
video_domain,				
codigo_praca,				
tier,		
dvr,			
seac_user,				
content_rating,				
content_rating_criteria,
release_year,				
genre_name,			
directors_name,			
released_at,				
channel_name,			
technical_specs_resolutions,				
deeplink,				
subset_id,				
video_available_for
)
SELECT
id_consumption,				
user_id_new,
video_id,				
session_id,				
date,				
hour,				
minute,				
user_age,				
user_gender,				
session_name,				
program_name,				
program_details,				
video_name,				
video_name_slug,				
episode_name,			
operacional_system,				
consumption_country,				
consumption_region,				
registration_region,				
consumption_city,				
service_id,				
streaming_type,				
video_type,				
program_id,			
open_video,				
consumption_environment,				
tv_manufacturer,			
tv_model,			
video_domain,				
codigo_praca,				
tier,		
dvr,			
seac_user,				
content_rating,				
content_rating_criteria,
release_year,				
genre_name,			
directors_name,			
released_at,				
channel_name,			
technical_specs_resolutions,				
deeplink,				
subset_id,				
video_available_for,
FROM
    ${ref("manipulate_data_dimension_tc")};



INSERT INTO dataset.${dataform.projectConfig.vars.DATASET_NAME}.fact_vmd(
id_metrics,				
user_id_new,
video_id,				
video_name,				
origin_name,				
video_bucket_10,				
video_bucket_25,				
video_bucket_50,				
video_bucket_75,				
video_bucket_90,				
video_bucket_100,				
video_views,				
seconds_watched,				
video_duration,				
video_fully_watched_threshold,				
date
)
SELECT
id_metrics,				
user_id_new,
video_id,				
video_name,				
origin_name,				
video_bucket_10,				
video_bucket_25,				
video_bucket_50,				
video_bucket_75,				
video_bucket_90,				
video_bucket_100,				
video_views,				
seconds_watched,				
video_duration,				
video_fully_watched_threshold,				
date,
FROM
    ${ref("manipulate_data_fact_vmd")};
